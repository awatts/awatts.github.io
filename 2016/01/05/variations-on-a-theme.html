<!DOCTYPE html><html class="" lang="en"><head><meta charset="utf-8"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="https://awatts.us/2016/01/05/variations-on-a-theme.html" rel="canonical"><meta name='generator' content='Octopress v Jekyll v2.5.3, Octopress v3.0.11 Octopress Ink v1.2.1'><link href='/stylesheets/all-9d2821276df1bcde167410ce0c2bf9a0.css' media='all' rel='stylesheet' type='text/css'></head><body> <style>use{height:0}</style><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:a="http://ns.adobe.com/AdobeSVGViewerExtensions/3.0/" style="display:none"> <g id="site-search-svg"><path d="M125.7,120l-5.7,5.7c-1.5,1.5-3.5,2.3-5.7,2.3c-2.1,0-4.2-0.8-5.7-2.3L72.4,89.3C65.2,93.6,56.9,96,48,96 C21.5,96,0,74.5,0,48S21.5,0,48,0s48,21.5,48,48c0,8.9-2.4,17.2-6.7,24.4l36.3,36.3C128.8,111.8,128.8,116.9,125.7,120z M48,80 c17.7,0,32-14.3,32-32S65.7,16,48,16c-17.7,0-32,14.3-32,32S30.3,80,48,80z"/></g> </svg><div class="site"><div class='nav-panel'> <nav class='mobile-nav' role="navigation"><div class='mobile-nav-item mobile-nav-search'><form class='site-search' action="https://google.com/search"> <input type="hidden" name="sitesearch" value="awatts.us"> <input id='site-search-mobile' class="site-search-input"  name="q" results="0" placeholder="Search" accesskey="/"> <label class='site-search-label' for='site-search-mobile'><svg class='site-search-icon' viewBox="0 0 128 128"> <use xlink:href="#site-search-svg"></use> </svg></label></form></div> <a class="mobile-nav-item" href="/"/>Posts</a> <a class="mobile-nav-item" href="/archive/">Archive</a> <a class="mobile-nav-item" href="/feed/">Subscribe</a> </nav></div><div class="site-content"><div class="site-top"><div class="site-top-content"> <header role="banner" class="site-header"><h1 class="site-title"><a class="site-title-link" href="/"/>Andrew Watts's Blog</a></h1> </header> <nav class='main-nav' role="navigation"> <a class="main-nav-item" href="/"/>Posts</a> <a class="main-nav-item" href="/archive/">Archive</a> <a class="main-nav-item" href="/feed/">Subscribe</a><div class='main-nav-item main-nav-search'><form class='site-search' action="https://google.com/search"> <input type="hidden" name="sitesearch" value="awatts.us"> <input id='site-search-main' class="site-search-input"  name="q" results="0" placeholder="Search" accesskey="/"> <label class='site-search-label' for='site-search-main'><svg class='site-search-icon' viewBox="0 0 128 128"> <use xlink:href="#site-search-svg"></use> </svg></label></form></div> <button class="mobile-nav-toggle" href="#" onclick="!function(){document.querySelector('html').classList.toggle('mobile-nav-active')}()"><span class="mobile-nav-icon"></span><span class="hidden-label">Navigate<span></span></span></button> </nav></div></div><div class="site-main"><div class="main"><div class="main-content"> <article class="entry post" role="article"> <header class="entry-header"><div class='entry-header-content'><h1 class="entry-title">Variations on a Theme</h1></div> </header><div class="entry-meta"><a class='entry-date' href="/2016/01/05/variations-on-a-theme.html"><time class='entry-date' datetime='2016-01-05T21:06:54-05:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>5</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span></time></a></div><div class="entry-content"> <article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header class="post-header"><h1 class="post-title" itemprop="name headline">Variations on a Theme</h1><p class="post-meta"><time datetime="2016-01-05T21:06:54-05:00" itemprop="datePublished">Jan 5, 2016</time></p> </header><div class="post-content" itemprop="articleBody"><p>I want to look at some different ways of writing code in different languages that may be more or less readable and understandable.</p><p>To this end I'm going to take some code I wrote at work to parse a text based file format we created for storing region information from Self Paced Reading stimuli for an app that can't handle Linger style regioned sentences. It ended up getting a bit terse with all the list and dictionary comprehensions. Simultaneously idiomatic Python and yet almost Perl-esque in its line noisiness.</p><figure class='code-highlight-figure'><div class='code-highlight'><pre class='code-highlight-pre'><div data-line='1' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="k">def</span> <span class="nf">parse_region_file</span><span class="p">(</span><span class="n">region_file</span><span class="p">):</span>
</div></div><div data-line='2' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="sd">"""</span>
</div></div><div data-line='3' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="sd">    Read in a region file and return a list of dicts of regions.</span>
</div></div><div data-line='4' class='code-highlight-row numbered'><div class='code-highlight-line'> </div></div><div data-line='5' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="sd">    Contents of region file should be a sequence of lines with</span>
</div></div><div data-line='6' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="sd">    an item number, pipe and zero or more span specifications like</span>
</div></div><div data-line='7' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="sd">    'label:startindex,endindex', e.g.</span>
</div></div><div data-line='8' class='code-highlight-row numbered'><div class='code-highlight-line'> </div></div><div data-line='9' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="sd">    1|subject:0,1;verb:1,2;object:2,6</span>
</div></div><div data-line='10' class='code-highlight-row numbered'><div class='code-highlight-line'><span class="sd">    """</span>
</div></div><div data-line='11' class='code-highlight-row numbered'><div class='code-highlight-line'>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">region_file</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">rfile</span><span class="p">:</span>
</div></div><div data-line='12' class='code-highlight-row numbered'><div class='code-highlight-line'>        <span class="n">splitreg</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">'|'</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rfile</span><span class="o">.</span><span class="n">readlines</span><span class="p">()]</span>
</div></div><div data-line='13' class='code-highlight-row numbered'><div class='code-highlight-line'> </div></div><div data-line='14' class='code-highlight-row numbered'><div class='code-highlight-line'>        <span class="n">regdict</span> <span class="o">=</span> <span class="p">{</span><span class="nb">int</span><span class="p">(</span><span class="n">reg</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> <span class="n">reg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">';'</span><span class="p">)</span> <span class="k">if</span> <span class="n">reg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s">''</span> <span class="k">else</span> <span class="p">[</span><span class="s">'NA:0,0'</span><span class="p">,</span> <span class="p">]</span>
</div></div><div data-line='15' class='code-highlight-row numbered'><div class='code-highlight-line'>                   <span class="k">for</span> <span class="n">reg</span> <span class="ow">in</span> <span class="n">splitreg</span><span class="p">}</span>
</div></div><div data-line='16' class='code-highlight-row numbered'><div class='code-highlight-line'> </div></div><div data-line='17' class='code-highlight-row numbered'><div class='code-highlight-line'>        <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="p">{</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">y</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">':'</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">v</span><span class="p">]}</span>
</div></div><div data-line='18' class='code-highlight-row numbered'><div class='code-highlight-line'>                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">regdict</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span></div></div></pre></div></figure></div><div class="post-comments"><div id="disqus_thread"></div> <script>var disqus_shortname="awatts",disqus_url="https://awatts.us/2016/01/05/variations-on-a-theme.html",disqus_identifier="https://awatts.us/2016/01/05/variations-on-a-theme.html",disqus_title="Variations on a Theme";!function(){var t=document.createElement("script");t.async=!0,t.type="text/javascript",t.src="//awatts.disqus.com/embed.js",(document.getElementsByTagName("HEAD")[0]||document.getElementsByTagName("BODY")[0]).appendChild(t)}()</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></div></article><div class="entry-social-sharing social-links"><a class="twitter-share-link" href="https://twitter.com/intent/tweet?&text=Variations%20on%20a%20Theme%20by%20%40awatts_%20%20-%20https%3A%2F%2Fawatts.us%2F2016%2F01%2F05%2Fvariations-on-a-theme.html" title="Share on Twitter">Twitter</a><a class="facebook-share-link" href="https://www.facebook.com/sharer/sharer.php?u=https://awatts.us/2016/01/05/variations-on-a-theme.html" title="Share on Facebook">Facebook</a><a class="g-plus-share-link" href="https://plus.google.com/share?url=https://awatts.us/2016/01/05/variations-on-a-theme.html" title="Share on Google+">Google+</a><a class="email-share-link" href="mailto:?subject=Variations%20on%20a%20Theme&body=Variations%20on%20a%20Theme%20%20-%20https%3A%2F%2Fawatts.us%2F2016%2F01%2F05%2Fvariations-on-a-theme.html" title="Share via email">Email</a></div><nav role="pagination" class="post-nav"><a class="previous-post" href="/2016/01/01/my-20th-linuxversary.html" title="Previous Article: My 20th Linuxversary"><div class='previous-post-marker'><span class='previous-post-arrow'>←</span> Previous Article</div><h6 class='previous-post-title'>My 20th Linuxversary</h6> </a></nav></div><footer class='entry-footer' role='contentinfo'> </footer></article></div></div></div><div class="site-bottom"><div class="site-bottom-content"> <footer class='site-footer' role="contentinfo"><p class='footer-copyright'>Copyright © 2016 - Powered by <a href='http://octopress.org'>Octopress</a></p> </footer></div></div></div></div> <script async src='/javascripts/all-0b454385761705d0d505b475dda19b65.js'></script></body></html>